<%= turbo_stream_from "chat_#{@chat.id}" %>

<% content_for :title, "RubyLLM Chat" %>

<div class="w-full max-w-4xl mx-auto p-6 bg-white">
  <% if notice %>
    <div class="mb-4 p-4 text-green-800 bg-green-100 border border-green-200 rounded-lg">
      <%= notice %>
    </div>
  <% end %>
  <!-- Header -->
  <div class="mb-6 pb-4 border-b border-gray-200">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">RubyLLM Chat <%= @chat.id %></h1>
    <div class="flex items-center text-sm text-gray-600 gap-2">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
      </svg>
      Using <%= link_to @chat.model_association.name, @chat.model_association, class: "underline text-gray-900 font-bold" %>
    </div>
  </div>

  <!-- Messages Container -->
  <div id="messages" class="mb-8 space-y-4 max-h-96 overflow-y-auto bg-gray-50 rounded-lg p-4">
    <% @chat.messages_association.where.not(id: nil).each do |message| %>
      <%= render "messages/message", message: message %>
    <% end %>
  </div>

  <!-- Message Form -->
  <div class="mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
    <%= render "messages/form", chat: @chat, message: @message %>
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center pt-4 border-t border-gray-200">
    <%= link_to "Back to chats", chats_path, 
        class: "inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-900 transition-colors duration-200" %>
    
    <div class="text-xs text-gray-500">
      Chat ID: <%= @chat.id %>
    </div>
  </div>
</div>